{"ast":null,"code":"import { ADD_RECIPE, DELETE_RECIPE, EDIT_RECIPE, LOGIN, LOGOUT, DELETE_ACCOUNT, LOAD_USER, SIGNUP, VERIFY } from './actionType';\nimport axios from 'axios';\nimport setAuth from '../utils/setAuth.js'; //if token expires, remove authentication and remove token [dispatch logout]\n\nfunction auth() {\n  setAuth(localStorage.token);\n}\n\nexport const userInfo = () => async dispatch => {\n  //loads the user info (name, food entries)\n  console.log('we are getting the user info rn');\n\n  if (localStorage.token) {\n    setAuth(localStorage.token);\n  }\n\n  try {\n    console.log('inside api call');\n    const res = await axios.get('/api/foodentries/entries', {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    console.log(res.data);\n    dispatch({\n      type: LOAD_USER,\n      payload: res.data\n    });\n  } catch (err) {\n    console.log(err);\n  }\n};\nexport const login = (email, password) => async dispatch => {\n  //logs a user in\n  try {\n    const res = await axios.post('/api/auth/login', {\n      \"email\": email,\n      \"password\": password\n    }, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    dispatch({\n      type: LOGIN,\n      payload: res.data\n    });\n    auth(); //add authorization\n  } catch (error) {\n    console.log('error caught in action.js');\n  }\n};\nexport const signup = (email, password) => async dispatch => {\n  //creates a new user\n  //checks if there is a user with that credential\n  try {\n    const res = await axios.post('/api/auth/signup', {\n      \"email\": email,\n      \"password\": password\n    }, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    dispatch({\n      type: SIGNUP,\n      payload: res.data\n    });\n  } catch (error) {\n    console.log('error caught in action.js');\n  }\n};\nexport const resume = () => dispatch => {\n  //checks if crendentials are valid\n  console.log('resume');\n  const token = localStorage.getItem('token');\n  axios.post('/api/auth/verify', {\n    token: token\n  }, {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  }).then(result => {\n    dispatch({\n      type: VERIFY,\n      payload: result.data\n    });\n    auth();\n  }).catch(error => {\n    console.log(error);\n  });\n};\nexport const logout = () => async (dispatch) => //remove token\ndispatch({\n  type: LOGOUT\n});\nexport const addRecipe = formdata => async dispatch => {\n  //adds a recipe to the entries\n  try {\n    // put /add at the end when finished\n    const res = await axios.post('/api/foodentries/', formdata);\n    console.log(res.data);\n    dispatch({\n      type: ADD_RECIPE,\n      payload: res.data\n    });\n  } catch (error) {\n    console.log('error caught in action.js');\n  }\n}; //PASS IMAGE KEY AND NAME FOR DELETION\n\nexport const deleteRecipe = (id, index, imageKey) => async dispatch => {\n  //deletes a recipe\n  try {\n    const res = await axios.post('/api/foodentries/delete2', {\n      id: id,\n      imageKey: imageKey\n    }, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    dispatch({\n      type: DELETE_RECIPE,\n      index: index,\n      payload: res.data\n    });\n  } catch (error) {\n    console.log(error);\n  }\n}; //SEND PAST IMAGE NAME AND KEY\n\nexport const editRecipe = (recipe, index, prevImg) => async dispatch => {\n  //edits a recipe\n  try {\n    console.log(recipe);\n\n    for (var value of recipe.values()) {\n      console.log(value);\n    }\n\n    const res = await axios.post('/api/foodentries/edit2', {\n      index: index,\n      updatedObject: recipe,\n      prevImage: prevImg\n    }, {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    dispatch({\n      type: EDIT_RECIPE,\n      recipe: recipe,\n      index: index,\n      payload: res.data\n    });\n  } catch (error) {\n    console.log(error);\n  }\n};","map":{"version":3,"sources":["C:/Users/Kim/Documents/GitHub/recipe-keeps/client/src/redux/actions.js"],"names":["ADD_RECIPE","DELETE_RECIPE","EDIT_RECIPE","LOGIN","LOGOUT","DELETE_ACCOUNT","LOAD_USER","SIGNUP","VERIFY","axios","setAuth","auth","localStorage","token","userInfo","dispatch","console","log","res","get","headers","data","type","payload","err","login","email","password","post","error","signup","resume","getItem","then","result","catch","logout","addRecipe","formdata","deleteRecipe","id","index","imageKey","editRecipe","recipe","prevImg","value","values","updatedObject","prevImage"],"mappings":"AAAA,SAASA,UAAT,EAAqBC,aAArB,EAAoCC,WAApC,EAAiDC,KAAjD,EAAwDC,MAAxD,EAAgEC,cAAhE,EAAgFC,SAAhF,EAA2FC,MAA3F,EAAmGC,MAAnG,QAAgH,cAAhH;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,qBAApB,C,CAEA;;AAEA,SAASC,IAAT,GAAe;AACXD,EAAAA,OAAO,CAACE,YAAY,CAACC,KAAd,CAAP;AACH;;AAGD,OAAO,MAAMC,QAAQ,GAAG,MAAM,MAAMC,QAAN,IAAiB;AAC3C;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ;;AACA,MAAGL,YAAY,CAACC,KAAhB,EAAsB;AAClBH,IAAAA,OAAO,CAACE,YAAY,CAACC,KAAd,CAAP;AACH;;AACD,MAAG;AACCG,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACA,UAAMC,GAAG,GAAI,MAAMT,KAAK,CAACU,GAAN,CAAU,0BAAV,EACnB;AAACC,MAAAA,OAAO,EAAE;AACN,wBAAgB;AADV;AAAV,KADmB,CAAnB;AAIAJ,IAAAA,OAAO,CAACC,GAAR,CAAYC,GAAG,CAACG,IAAhB;AACAN,IAAAA,QAAQ,CAAC;AACLO,MAAAA,IAAI,EAAEhB,SADD;AAELiB,MAAAA,OAAO,EAAEL,GAAG,CAACG;AAFR,KAAD,CAAR;AAIH,GAXD,CAYA,OAAMG,GAAN,EAAU;AACFR,IAAAA,OAAO,CAACC,GAAR,CAAYO,GAAZ;AACP;AACJ,CArBM;AAyBP,OAAO,MAAMC,KAAK,GAAG,CAACC,KAAD,EAAQC,QAAR,KAAqB,MAAMZ,QAAN,IAAiB;AACvD;AACA,MAAI;AACA,UAAMG,GAAG,GAAG,MAAMT,KAAK,CAACmB,IAAN,CAAW,iBAAX,EAClB;AAAC,eAASF,KAAV;AACC,kBAAYC;AADb,KADkB,EAGlB;AAACP,MAAAA,OAAO,EAAE;AAAC,wBAAgB;AAAjB;AAAV,KAHkB,CAAlB;AAKAL,IAAAA,QAAQ,CAAC;AACLO,MAAAA,IAAI,EAAEnB,KADD;AAELoB,MAAAA,OAAO,EAAEL,GAAG,CAACG;AAFR,KAAD,CAAR;AAKAV,IAAAA,IAAI,GAXJ,CAWO;AACV,GAZD,CAaA,OAAOkB,KAAP,EAAc;AACVb,IAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH;AACJ,CAlBM;AAuBP,OAAO,MAAMa,MAAM,GAAG,CAACJ,KAAD,EAAQC,QAAR,KAAqB,MAAMZ,QAAN,IAAiB;AACxD;AACA;AACA,MAAI;AACA,UAAMG,GAAG,GAAG,MAAMT,KAAK,CAACmB,IAAN,CAAW,kBAAX,EAClB;AAAC,eAASF,KAAV;AACC,kBAAYC;AADb,KADkB,EAGlB;AAACP,MAAAA,OAAO,EAAE;AAAC,wBAAgB;AAAjB;AAAV,KAHkB,CAAlB;AAKAL,IAAAA,QAAQ,CAAC;AACLO,MAAAA,IAAI,EAAEf,MADD;AAELgB,MAAAA,OAAO,EAAEL,GAAG,CAACG;AAFR,KAAD,CAAR;AAIH,GAVD,CAWA,OAAOQ,KAAP,EAAc;AACVb,IAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH;AACJ,CAjBM;AAoBP,OAAO,MAAMc,MAAM,GAAG,MAAMhB,QAAQ,IAAG;AACnC;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACA,QAAMJ,KAAK,GAAGD,YAAY,CAACoB,OAAb,CAAqB,OAArB,CAAd;AAEIvB,EAAAA,KAAK,CAACmB,IAAN,CAAW,kBAAX,EACA;AAACf,IAAAA,KAAK,EAAEA;AAAR,GADA,EAEA;AAACO,IAAAA,OAAO,EAAE;AAAC,sBAAgB;AAAjB;AAAV,GAFA,EAGEa,IAHF,CAGOC,MAAM,IAAE;AACXnB,IAAAA,QAAQ,CAAC;AACLO,MAAAA,IAAI,EAAEd,MADD;AAELe,MAAAA,OAAO,EAAEW,MAAM,CAACb;AAFX,KAAD,CAAR;AAIAV,IAAAA,IAAI;AACP,GATD,EASGwB,KATH,CASSN,KAAK,IAAE;AACZb,IAAAA,OAAO,CAACC,GAAR,CAAYY,KAAZ;AACH,GAXD;AAaP,CAlBM;AAsBP,OAAO,MAAMO,MAAM,GAAG,MAAM,OAAMrB,QAAN,KACxB;AACAA,QAAQ,CAAC;AACTO,EAAAA,IAAI,EAAElB;AADG,CAAD,CAFL;AAWP,OAAO,MAAMiC,SAAS,GAAIC,QAAD,IAAc,MAAMvB,QAAN,IAAiB;AACpD;AACA,MAAI;AAAC;AACD,UAAMG,GAAG,GAAG,MAAMT,KAAK,CAACmB,IAAN,CAAW,mBAAX,EAClBU,QADkB,CAAlB;AAGAtB,IAAAA,OAAO,CAACC,GAAR,CAAYC,GAAG,CAACG,IAAhB;AACAN,IAAAA,QAAQ,CAAC;AACLO,MAAAA,IAAI,EAAEtB,UADD;AAELuB,MAAAA,OAAO,EAAEL,GAAG,CAACG;AAFR,KAAD,CAAR;AAIH,GATD,CAUA,OAAOQ,KAAP,EAAc;AACVb,IAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH;AACJ,CAfM,C,CAkBP;;AACA,OAAO,MAAMsB,YAAY,GAAG,CAACC,EAAD,EAAKC,KAAL,EAAYC,QAAZ,KAAyB,MAAM3B,QAAN,IAAiB;AAClE;AACA,MAAG;AACC,UAAMG,GAAG,GAAG,MAAMT,KAAK,CAACmB,IAAN,CAAW,0BAAX,EAClB;AAACY,MAAAA,EAAE,EAAEA,EAAL;AACAE,MAAAA,QAAQ,EAAEA;AADV,KADkB,EAGlB;AAACtB,MAAAA,OAAO,EAAE;AAAC,wBAAgB;AAAjB;AAAV,KAHkB,CAAlB;AAKAL,IAAAA,QAAQ,CAAC;AACLO,MAAAA,IAAI,EAAErB,aADD;AAELwC,MAAAA,KAAK,EAAEA,KAFF;AAGLlB,MAAAA,OAAO,EAAEL,GAAG,CAACG;AAHR,KAAD,CAAR;AAKH,GAXD,CAYA,OAAMQ,KAAN,EAAY;AACRb,IAAAA,OAAO,CAACC,GAAR,CAAYY,KAAZ;AACH;AACJ,CAjBM,C,CAoBP;;AACA,OAAO,MAAMc,UAAU,GAAG,CAACC,MAAD,EAASH,KAAT,EAAgBI,OAAhB,KAA4B,MAAM9B,QAAN,IAAiB;AACnE;AACA,MAAG;AACCC,IAAAA,OAAO,CAACC,GAAR,CAAY2B,MAAZ;;AACA,SAAK,IAAIE,KAAT,IAAkBF,MAAM,CAACG,MAAP,EAAlB,EAAmC;AAC/B/B,MAAAA,OAAO,CAACC,GAAR,CAAY6B,KAAZ;AACF;;AACF,UAAM5B,GAAG,GAAG,MAAMT,KAAK,CAACmB,IAAN,CAAW,wBAAX,EAClB;AAACa,MAAAA,KAAK,EAAEA,KAAR;AACAO,MAAAA,aAAa,EAAEJ,MADf;AAEAK,MAAAA,SAAS,EAAEJ;AAFX,KADkB,EAIlB;AAACzB,MAAAA,OAAO,EAAE;AAAC,wBAAgB;AAAjB;AAAV,KAJkB,CAAlB;AAMAL,IAAAA,QAAQ,CAAC;AAACO,MAAAA,IAAI,EAAEpB,WAAP;AACL0C,MAAAA,MAAM,EAACA,MADF;AAELH,MAAAA,KAAK,EAAEA,KAFF;AAGLlB,MAAAA,OAAO,EAAEL,GAAG,CAACG;AAHR,KAAD,CAAR;AAKH,GAhBD,CAiBA,OAAMQ,KAAN,EAAY;AACRb,IAAAA,OAAO,CAACC,GAAR,CAAYY,KAAZ;AACH;AACJ,CAtBM","sourcesContent":["import { ADD_RECIPE, DELETE_RECIPE, EDIT_RECIPE, LOGIN, LOGOUT, DELETE_ACCOUNT, LOAD_USER, SIGNUP, VERIFY} from './actionType';\r\nimport axios from 'axios';\r\nimport setAuth from '../utils/setAuth.js';\r\n\r\n//if token expires, remove authentication and remove token [dispatch logout]\r\n\r\nfunction auth(){\r\n    setAuth(localStorage.token);\r\n}\r\n\r\n\r\nexport const userInfo = () => async dispatch =>{\r\n    //loads the user info (name, food entries)\r\n    console.log('we are getting the user info rn');\r\n    if(localStorage.token){\r\n        setAuth(localStorage.token);\r\n    }\r\n    try{\r\n        console.log('inside api call');\r\n        const res =  await axios.get('/api/foodentries/entries', \r\n        {headers: {\r\n            'Content-Type': 'application/json'}\r\n        })\r\n        console.log(res.data);\r\n        dispatch({\r\n            type: LOAD_USER,\r\n            payload: res.data\r\n            });\r\n    }\r\n    catch(err){\r\n            console.log(err);\r\n    } \r\n}\r\n\r\n\r\n\r\nexport const login = (email, password) => async dispatch =>{\r\n    //logs a user in\r\n    try {\r\n        const res = await axios.post('/api/auth/login', \r\n        {\"email\": email,\r\n         \"password\": password},\r\n        {headers: {'Content-Type': 'application/json'}}   \r\n        );\r\n        dispatch({\r\n            type: LOGIN,\r\n            payload: res.data\r\n        });\r\n\r\n        auth();//add authorization\r\n    } \r\n    catch (error) {\r\n        console.log('error caught in action.js');\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nexport const signup = (email, password) => async dispatch =>{\r\n    //creates a new user\r\n    //checks if there is a user with that credential\r\n    try {\r\n        const res = await axios.post('/api/auth/signup', \r\n        {\"email\": email,\r\n         \"password\": password},\r\n        {headers: {'Content-Type': 'application/json'}}   \r\n        );\r\n        dispatch({\r\n            type: SIGNUP,\r\n            payload: res.data\r\n        });\r\n    } \r\n    catch (error) {\r\n        console.log('error caught in action.js');\r\n    }\r\n}\r\n\r\n\r\nexport const resume = () => dispatch =>{\r\n    //checks if crendentials are valid\r\n    console.log('resume');\r\n    const token = localStorage.getItem('token');\r\n\r\n        axios.post('/api/auth/verify',\r\n        {token: token},\r\n        {headers: {'Content-Type': 'application/json'}}   \r\n        ).then(result=>{\r\n            dispatch({\r\n                type: VERIFY,\r\n                payload: result.data\r\n            });\r\n            auth();\r\n        }).catch(error=>{\r\n            console.log(error);\r\n        })\r\n\r\n}\r\n\r\n\r\n\r\nexport const logout = () => async dispatch => (\r\n    //remove token\r\n    dispatch({\r\n    type: LOGOUT\r\n    })\r\n)\r\n\r\n\r\n\r\n\r\n\r\nexport const addRecipe = (formdata) => async dispatch =>{\r\n    //adds a recipe to the entries\r\n    try {// put /add at the end when finished\r\n        const res = await axios.post('/api/foodentries/',\r\n        formdata   \r\n        );\r\n        console.log(res.data);\r\n        dispatch({\r\n            type: ADD_RECIPE,\r\n            payload: res.data\r\n        });\r\n    } \r\n    catch (error) {\r\n        console.log('error caught in action.js');\r\n    }\r\n}\r\n\r\n\r\n//PASS IMAGE KEY AND NAME FOR DELETION\r\nexport const deleteRecipe = (id, index, imageKey) => async dispatch =>{\r\n    //deletes a recipe\r\n    try{\r\n        const res = await axios.post('/api/foodentries/delete2',\r\n        {id: id,\r\n        imageKey: imageKey},\r\n        {headers: {'Content-Type': 'application/json'}},        \r\n        );\r\n        dispatch({\r\n            type: DELETE_RECIPE,\r\n            index: index,\r\n            payload: res.data\r\n            })\r\n    }\r\n    catch(error){\r\n        console.log(error);\r\n    }\r\n}\r\n\r\n\r\n//SEND PAST IMAGE NAME AND KEY\r\nexport const editRecipe = (recipe, index, prevImg) => async dispatch =>{\r\n    //edits a recipe\r\n    try{\r\n        console.log(recipe);\r\n        for (var value of recipe.values()) {\r\n            console.log(value); \r\n         }\r\n        const res = await axios.post('/api/foodentries/edit2',\r\n        {index: index,\r\n        updatedObject: recipe,\r\n        prevImage: prevImg},\r\n        {headers: {'Content-Type': 'application/json'}}        \r\n        )\r\n        dispatch({type: EDIT_RECIPE,\r\n            recipe:recipe,\r\n            index: index,\r\n            payload: res.data\r\n        })\r\n    }\r\n    catch(error){\r\n        console.log(error);\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}