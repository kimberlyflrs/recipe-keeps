{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Kim\\\\Documents\\\\GitHub\\\\recipe-keeps\\\\client\\\\src\\\\components\\\\RecipeForm.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { addRecipe, deleteRecipe, editRecipe, userInfo, loading, error } from '../redux/actions';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Modal from 'react-bootstrap/Modal';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nimport { Redirect } from 'react-router-dom';\nimport Loading from '../components/Loading.js'; //Recipe Form can display edit mode and create a new recipe\n\nclass RecipeForm extends React.Component {\n  constructor(props) {\n    super();\n\n    this.mySubmitHandler = event => {\n      event.preventDefault();\n      const file = document.getElementById('recipe_image').files;\n      const formData = new FormData();\n      formData.append(\"img\", file[0]);\n      var name = document.getElementById(\"name\").value;\n      var prep = document.forms[\"recipeForm\"][\"prep\"].value;\n      var cook = document.forms[\"recipeForm\"][\"cook\"].value;\n      var ingredients = document.forms[\"recipeForm\"][\"ingredients\"].value;\n      var directions = document.forms[\"recipeForm\"][\"directions\"].value;\n      formData.append(\"name\", name);\n      formData.append(\"prep_time\", prep);\n      formData.append(\"cook_time\", cook);\n      formData.append(\"ingredients\", ingredients);\n      formData.append(\"directions\", directions);\n      this.props.loading();\n\n      if (this.state.newRecipe) {\n        formData.append(\"imgKey\", \" \");\n        formData.append(\"imgLoc\", \" \");\n        this.addRecipe(formData);\n      } else {\n        //passing new recipe and image, index, old filename\n        formData.append(\"index\", this.state.index);\n        formData.append(\"imgKey\", this.state.key);\n        formData.append(\"imgLoc\", this.state.location);\n        this.editRecipe(formData, this.state.index);\n      }\n    };\n\n    this.state = {\n      recipe: props.recipe,\n      name: props.recipe.name || \"\",\n      prep: props.recipe.prep_time || \"\",\n      cook: props.recipe.cook_time || \"\",\n      ingredients: props.recipe.ingredients || \"\",\n      directions: props.recipe.directions || \"\",\n      image: props.recipe.image || \"\",\n      //preview image\n      key: props.recipe.imageKey || \"\",\n      //previous image key \n      location: props.recipe.image || \"\",\n      //previous image name\n      file: \"\",\n      //image file\n      newRecipe: props.newRecipe,\n      //true or false [if true, empty form else preload it with info]\n      showModal: false,\n      index: props.index,\n      //used to index in backend and redux state\n      link: \"\",\n      navBackRecipe: false,\n      navAllRecipe: false //go to all recipes\n\n    };\n    this.handleInputChange = this.handleInputChange.bind(this);\n    this.mySubmitHandler = this.mySubmitHandler.bind(this);\n    this.addRecipe = this.addRecipe.bind(this);\n    this.editRecipe = this.editRecipe.bind(this);\n    this.deleteRecipe = this.deleteRecipe.bind(this);\n    this.showModal = this.showModal.bind(this);\n    this.handleClose = this.handleClose.bind(this);\n    this.backToAllRecipe = this.backToAllRecipe.bind(this);\n    this.previewImage = this.previewImage.bind(this);\n    this.deleteImage = this.deleteImage.bind(this);\n    this.fileSize = this.fileSize.bind(this);\n  }\n\n  async componentDidMount() {\n    await this.props.userInfo();\n  }\n\n  handleInputChange(e) {\n    this.setState({\n      [e.target.name]: e.target.value\n    });\n  }\n\n  async addRecipe(recipe) {\n    //adds the recipe and then redirects to all recipes\n    await this.props.addRecipe(recipe);\n\n    if (this.props.added) {\n      //check for an error instead (if successful, or token expired attempt back to all recipe)\n      this.backToAllRecipe();\n    }\n  }\n\n  async editRecipe(recipe, index) {\n    //edits the recipe and then redirects to all recipes\n    console.log('addRecipe has been clicked');\n    await this.props.editRecipe(recipe, index, this.state.key);\n\n    if (this.props.added) {\n      var recipe = {\n        name: this.state.name,\n        prep: this.state.prep,\n        cook: this.state.cook,\n        ingredients: this.state.ingredients,\n        directions: this.state.directions,\n        image: this.state.image,\n        //preview image\n        imageKey: this.state.key,\n        //previous image key \n        _id: this.state.recipe._id\n      };\n      this.setState({\n        recipe: recipe,\n        navBackRecipe: true,\n        link: \"/recipe/view/\" + this.state.recipe._id\n      });\n    }\n  }\n\n  async deleteRecipe() {\n    //Deletes a recipe from DB and then redirects to all recipes page\n    this.props.loading();\n    await this.props.deleteRecipe(this.state.recipe._id, this.state.index, this.state.key);\n    this.handleClose();\n    this.backToAllRecipe(true);\n  }\n\n  showModal() {\n    this.setState({\n      showModal: true\n    });\n  }\n\n  handleClose() {\n    this.setState({\n      showModal: false\n    });\n  }\n\n  backToAllRecipe(deleteRecipe) {\n    //if new recipe, go back to all recipes\n    //if recipe exists, go back to that recipe\n    if (this.state.newRecipe || deleteRecipe === true) {\n      this.setState({\n        navAllRecipe: true\n      });\n    } else {\n      console.log(this.state.recipe._id);\n      this.setState({\n        navBackRecipe: true,\n        link: \"/recipe/view/\" + this.state.recipe._id\n      });\n    }\n  }\n\n  previewImage(event) {\n    //allows the user to preview image before uploading\n    size = this.fileSize(event.target.files[0]);\n\n    if (size) {\n      this.setState({\n        image: URL.createObjectURL(event.target.files[0])\n      });\n    } else {\n      return error(\"File must be < 2 MB.\");\n    }\n  }\n\n  deleteImage() {\n    //removes the image file\n    document.getElementById('recipe_image').value = null;\n    this.setState({\n      file: \"\",\n      image: \"\",\n      imageKey: \"\",\n      location: \"\"\n    });\n  }\n\n  fileSize(file) {\n    //checks that the file size is under mb\n    //returns true if meets size, false if otherwise\n    var size = file.files[0].size / 1024 / 1024;\n\n    if (size > 2) {\n      //2 mb\n      return false;\n    }\n\n    return true;\n  }\n\n  render() {\n    if (this.state.navAllRecipe) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/viewRecipes\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 20\n        }\n      });\n    }\n\n    if (!this.props.loggedIn) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: \"/login\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 20\n        }\n      });\n    }\n\n    if (this.state.navBackRecipe) {\n      console.log(this.state.link);\n      console.log(this.state.recipe);\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: {\n          pathname: this.state.link,\n          state: {\n            recipe: this.state.recipe,\n            index: this.state.index\n          }\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 20\n        }\n      });\n    }\n\n    var buttons;\n    var title;\n\n    if (this.state.newRecipe) {\n      buttons = /*#__PURE__*/React.createElement(Button, {\n        type: \"submit\",\n        className: \"btn-bblue\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 23\n        }\n      }, \"Add Recipe\");\n      title = \"Add a Recipe\";\n    } else {\n      buttons = /*#__PURE__*/React.createElement(Button, {\n        type: \"submit\",\n        className: \"btn-bblue\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 23\n        }\n      }, \"Save\");\n      var deleteBtn = /*#__PURE__*/React.createElement(Button, {\n        className: \"btn-delete\",\n        variant: \"danger\",\n        onClick: this.showModal,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 29\n        }\n      }, \"Delete\");\n      title = \"Editing a Recipe\";\n    }\n\n    if (this.props.isLoading) {\n      return /*#__PURE__*/React.createElement(Loading, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 17\n        }\n      });\n    } else {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form center editRecipe\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Row, {\n        className: \"spacing\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        className: \"btn-bblue\",\n        onClick: this.backToAllRecipe,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 17\n        }\n      }, \"Back To Recipe\")), /*#__PURE__*/React.createElement(Col, {\n        className: \"right\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 17\n        }\n      }, deleteBtn)), /*#__PURE__*/React.createElement(\"h1\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 13\n        }\n      }, title), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"center error\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 13\n        }\n      }, this.props.error), /*#__PURE__*/React.createElement(Form, {\n        name: \"recipeForm\",\n        onSubmit: this.mySubmitHandler,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Form.Group, {\n        as: Row,\n        className: \"left-text spacing\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Form.Label, {\n        column: true,\n        sm: \"2\",\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 17\n        }\n      }, \"Recipe Name\"), /*#__PURE__*/React.createElement(Col, {\n        sm: \"10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Form.Control, {\n        type: \"text\",\n        name: \"name\",\n        id: \"name\",\n        value: this.state.name,\n        onChange: this.handleInputChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 17\n        }\n      }))), /*#__PURE__*/React.createElement(Form.Group, {\n        as: Row,\n        className: \"left-text spacing\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Form.Label, {\n        column: true,\n        sm: \"12\",\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 17\n        }\n      }, \"Image Upload\")), /*#__PURE__*/React.createElement(Form.Group, {\n        as: Row,\n        className: \"left-text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Form.File, {\n        id: \"recipe_image\",\n        label: \"Upload Image\",\n        accept: \"image/*\",\n        onChange: this.previewImage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"img\", {\n        src: this.state.image,\n        className: \"recipe-image\",\n        id: \"preview\",\n        alt: \"No file found\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(Button, {\n        onClick: this.deleteImage,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 17\n        }\n      }, \"Remove Image\")), /*#__PURE__*/React.createElement(Form.Row, {\n        className: \"left-text spacing\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Col, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 271,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Form.Group, {\n        as: Row,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Form.Label, {\n        column: true,\n        sm: \"4\",\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 25\n        }\n      }, \"Prep Time:\"), /*#__PURE__*/React.createElement(Col, {\n        sm: \"7\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(Form.Control, {\n        name: \"prep\",\n        type: \"text\",\n        value: this.state.prep,\n        onChange: this.handleInputChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 25\n        }\n      })))), /*#__PURE__*/React.createElement(Col, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Form.Group, {\n        as: Row,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Form.Label, {\n        column: true,\n        sm: \"4\",\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 25\n        }\n      }, \"Cook Time:\"), /*#__PURE__*/React.createElement(Col, {\n        sm: \"7\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(Form.Control, {\n        name: \"cook\",\n        type: \"text\",\n        value: this.state.cook,\n        onChange: this.handleInputChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 25\n        }\n      }))))), /*#__PURE__*/React.createElement(Form.Group, {\n        className: \"left-text spacing\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Form.Label, {\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 13\n        }\n      }, \"Ingredients: \"), /*#__PURE__*/React.createElement(Form.Control, {\n        name: \"ingredients\",\n        as: \"textarea\",\n        rows: \"4\",\n        value: this.state.ingredients,\n        onChange: this.handleInputChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(Form.Group, {\n        className: \"left-text spacing\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Form.Label, {\n        className: \"title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 13\n        }\n      }, \"Directions\"), /*#__PURE__*/React.createElement(Form.Control, {\n        name: \"directions\",\n        as: \"textarea\",\n        rows: \"4\",\n        value: this.state.directions,\n        onChange: this.handleInputChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 17\n        }\n      })), buttons), /*#__PURE__*/React.createElement(Modal, {\n        show: this.state.showModal,\n        onHide: this.handleClose,\n        backdrop: \"static\",\n        keyboard: false,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Modal.Header, {\n        closeButton: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Modal.Title, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }\n      }, \"Delete Recipe\")), /*#__PURE__*/React.createElement(Modal.Body, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313,\n          columnNumber: 9\n        }\n      }, \"Are you sure you want to delete this recipe?\"), /*#__PURE__*/React.createElement(Modal.Footer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        variant: \"secondary\",\n        onClick: this.handleClose,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 11\n        }\n      }, \"No\"), /*#__PURE__*/React.createElement(Button, {\n        variant: \"danger\",\n        onClick: this.deleteRecipe,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }\n      }, \"Yes\"))));\n    }\n  }\n\n}\n\nconst mapDispatchToProps = {\n  addRecipe,\n  deleteRecipe,\n  editRecipe,\n  userInfo,\n  loading,\n  error\n};\n\nconst mapStateToProps = state => ({\n  added: state.added,\n  loggedIn: state.logged_in,\n  isLoading: state.isLoading,\n  error: state.error\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RecipeForm);","map":{"version":3,"sources":["C:/Users/Kim/Documents/GitHub/recipe-keeps/client/src/components/RecipeForm.js"],"names":["React","connect","addRecipe","deleteRecipe","editRecipe","userInfo","loading","error","Row","Col","Modal","Form","Button","Redirect","Loading","RecipeForm","Component","constructor","props","mySubmitHandler","event","preventDefault","file","document","getElementById","files","formData","FormData","append","name","value","prep","forms","cook","ingredients","directions","state","newRecipe","index","key","location","recipe","prep_time","cook_time","image","imageKey","showModal","link","navBackRecipe","navAllRecipe","handleInputChange","bind","handleClose","backToAllRecipe","previewImage","deleteImage","fileSize","componentDidMount","e","setState","target","added","console","log","_id","size","URL","createObjectURL","render","loggedIn","pathname","buttons","title","deleteBtn","isLoading","mapDispatchToProps","mapStateToProps","logged_in"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {addRecipe, deleteRecipe, editRecipe, userInfo, loading, error} from '../redux/actions';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport Row from 'react-bootstrap/Row';\r\nimport Col from 'react-bootstrap/Col';\r\nimport Modal from 'react-bootstrap/Modal';\r\nimport Form from 'react-bootstrap/Form';\r\nimport Button from 'react-bootstrap/Button';\r\nimport {Redirect} from 'react-router-dom';\r\nimport Loading from '../components/Loading.js';\r\n\r\n\r\n//Recipe Form can display edit mode and create a new recipe\r\n\r\nclass RecipeForm extends React.Component{\r\n    constructor(props){\r\n        super();\r\n        this.state = {\r\n            recipe: props.recipe,\r\n            name: props.recipe.name || \"\",\r\n            prep: props.recipe.prep_time || \"\",\r\n            cook: props.recipe.cook_time || \"\",\r\n            ingredients: props.recipe.ingredients || \"\",\r\n            directions: props.recipe.directions || \"\",\r\n            image: props.recipe.image ||\"\",//preview image\r\n            key: props.recipe.imageKey || \"\", //previous image key \r\n            location: props.recipe.image || \"\", //previous image name\r\n            file: \"\", //image file\r\n    \r\n            newRecipe: props.newRecipe, //true or false [if true, empty form else preload it with info]\r\n            showModal: false,\r\n            index: props.index,//used to index in backend and redux state\r\n            link: \"\",\r\n\r\n            navBackRecipe:false,\r\n            navAllRecipe:false //go to all recipes\r\n        }\r\n        this.handleInputChange = this.handleInputChange.bind(this);\r\n        this.mySubmitHandler = this.mySubmitHandler.bind(this);\r\n        this.addRecipe = this.addRecipe.bind(this);\r\n        this.editRecipe = this.editRecipe.bind(this);\r\n        this.deleteRecipe = this.deleteRecipe.bind(this);\r\n        this.showModal = this.showModal.bind(this);\r\n        this.handleClose = this.handleClose.bind(this);\r\n        this.backToAllRecipe = this.backToAllRecipe.bind(this);\r\n        this.previewImage = this.previewImage.bind(this);\r\n        this.deleteImage = this.deleteImage.bind(this);\r\n        this.fileSize = this.fileSize.bind(this);\r\n    }\r\n\r\n    async componentDidMount(){\r\n        await this.props.userInfo()\r\n    }\r\n\r\n    handleInputChange(e){\r\n        this.setState({\r\n            [e.target.name]: e.target.value\r\n        })\r\n    }\r\n\r\n    mySubmitHandler = (event) => {\r\n        event.preventDefault();\r\n        const file = document.getElementById('recipe_image').files;\r\n\r\n        const formData = new FormData(); \r\n        formData.append(\"img\", file[0]); \r\n\r\n        var name = document.getElementById(\"name\").value;\r\n        var prep = document.forms[\"recipeForm\"][\"prep\"].value;\r\n        var cook = document.forms[\"recipeForm\"][\"cook\"].value;\r\n        var ingredients = document.forms[\"recipeForm\"][\"ingredients\"].value;\r\n        var directions = document.forms[\"recipeForm\"][\"directions\"].value;\r\n\r\n\r\n        formData.append(\"name\", name);\r\n        formData.append(\"prep_time\", prep);\r\n        formData.append(\"cook_time\", cook);\r\n        formData.append(\"ingredients\", ingredients);\r\n        formData.append(\"directions\", directions);\r\n\r\n    \r\n        this.props.loading();\r\n        if(this.state.newRecipe){\r\n            formData.append(\"imgKey\", \" \");\r\n            formData.append(\"imgLoc\", \" \");\r\n            this.addRecipe(formData);\r\n        }\r\n        else{\r\n            //passing new recipe and image, index, old filename\r\n            formData.append(\"index\", this.state.index);\r\n            formData.append(\"imgKey\", this.state.key);\r\n            formData.append(\"imgLoc\", this.state.location);\r\n            this.editRecipe(formData, this.state.index);\r\n        }\r\n      }\r\n\r\n\r\n    async addRecipe(recipe){\r\n        //adds the recipe and then redirects to all recipes\r\n        await this.props.addRecipe(recipe);\r\n        if(this.props.added){//check for an error instead (if successful, or token expired attempt back to all recipe)\r\n            this.backToAllRecipe()\r\n        }\r\n    }\r\n\r\n\r\n    async editRecipe(recipe, index){\r\n        //edits the recipe and then redirects to all recipes\r\n        console.log('addRecipe has been clicked');\r\n        await this.props.editRecipe(recipe,index, this.state.key);\r\n        if(this.props.added){\r\n            var recipe = {\r\n                name: this.state.name,\r\n                prep: this.state.prep,\r\n                cook: this.state.cook,\r\n                ingredients: this.state.ingredients,\r\n                directions: this.state.directions,\r\n                image: this.state.image,//preview image\r\n                imageKey: this.state.key, //previous image key \r\n                _id: this.state.recipe._id\r\n            }\r\n            this.setState({\r\n                recipe: recipe,\r\n                navBackRecipe:true,\r\n                link: \"/recipe/view/\"+this.state.recipe._id\r\n            })\r\n        }\r\n    }\r\n\r\n    async deleteRecipe(){\r\n        //Deletes a recipe from DB and then redirects to all recipes page\r\n        this.props.loading();\r\n        await this.props.deleteRecipe(this.state.recipe._id, this.state.index, this.state.key);\r\n        this.handleClose();\r\n        this.backToAllRecipe(true);\r\n\r\n    }\r\n\r\n    showModal(){\r\n        this.setState({\r\n            showModal:true\r\n        })\r\n    }\r\n  \r\n    handleClose(){\r\n        this.setState({\r\n            showModal: false\r\n        })\r\n    }\r\n\r\n    backToAllRecipe(deleteRecipe){\r\n        //if new recipe, go back to all recipes\r\n        //if recipe exists, go back to that recipe\r\n        if(this.state.newRecipe || deleteRecipe===true){\r\n            this.setState({\r\n                navAllRecipe:true\r\n            })\r\n        }\r\n        else{\r\n            console.log(this.state.recipe._id);\r\n            this.setState({\r\n                navBackRecipe:true,\r\n                link: \"/recipe/view/\"+this.state.recipe._id\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    previewImage(event){\r\n        //allows the user to preview image before uploading\r\n        size = this.fileSize(event.target.files[0]);\r\n        if(size){\r\n            this.setState({\r\n                image: URL.createObjectURL(event.target.files[0]),\r\n              })\r\n        }\r\n        else{\r\n            return error(\"File must be < 2 MB.\")\r\n        }\r\n\r\n    }\r\n\r\n    deleteImage(){\r\n        //removes the image file\r\n        document.getElementById('recipe_image').value = null; \r\n        this.setState({\r\n            file: \"\",\r\n            image: \"\",\r\n            imageKey: \"\",\r\n            location: \"\"\r\n        })\r\n    }\r\n\r\n    fileSize(file){\r\n        //checks that the file size is under mb\r\n        //returns true if meets size, false if otherwise\r\n        var size = file.files[0].size / 1024 / 1024;\r\n        if (size>2){//2 mb\r\n            return false\r\n        }\r\n        return true\r\n    }\r\n\r\n\r\n\r\n    render(){\r\n        if(this.state.navAllRecipe){\r\n            return <Redirect to=\"/viewRecipes\"/>\r\n        }\r\n        if(!this.props.loggedIn){\r\n            return <Redirect to=\"/login\"/>\r\n        }\r\n        if(this.state.navBackRecipe){\r\n            console.log(this.state.link);\r\n            console.log(this.state.recipe);\r\n            return <Redirect to={{pathname: this.state.link, state:{recipe: this.state.recipe, index:this.state.index}} }/>\r\n        }\r\n        var buttons;\r\n        var title;\r\n        if(this.state.newRecipe){\r\n            buttons = <Button type=\"submit\" className=\"btn-bblue\">Add Recipe</Button>;\r\n            title = \"Add a Recipe\";\r\n        }\r\n        else{\r\n            buttons = <Button type=\"submit\" className=\"btn-bblue\">Save</Button>;\r\n            var deleteBtn = <Button className=\"btn-delete\" variant=\"danger\" onClick={this.showModal}>Delete</Button>;\r\n            title = \"Editing a Recipe\";\r\n\r\n        }\r\n\r\n        if(this.props.isLoading){\r\n            return(\r\n                <Loading/>\r\n            )\r\n        }\r\n\r\n        else{\r\n        return(\r\n        <div className=\"form center editRecipe\">\r\n            <Row className=\"spacing\">\r\n                <Col>\r\n                <Button className=\"btn-bblue\" onClick={this.backToAllRecipe}>Back To Recipe</Button>\r\n                </Col>\r\n                <Col className=\"right\">\r\n                {deleteBtn}\r\n                </Col>\r\n            </Row>\r\n\r\n            <h1>{title}</h1>\r\n            <p className=\"center error\">{this.props.error}</p>\r\n            <Form name=\"recipeForm\" onSubmit={this.mySubmitHandler}> \r\n            <Form.Group as={Row} className=\"left-text spacing\">\r\n                <Form.Label column sm=\"2\" className=\"title\">Recipe Name</Form.Label>\r\n                <Col sm=\"10\">\r\n                <Form.Control type=\"text\" name=\"name\" id=\"name\" value={this.state.name} onChange={this.handleInputChange}></Form.Control>\r\n                </Col>\r\n            </Form.Group>\r\n\r\n            <Form.Group as={Row} className=\"left-text spacing\">\r\n                <Form.Label column sm=\"12\" className=\"title\">Image Upload</Form.Label>\r\n            </Form.Group>\r\n            <Form.Group as={Row} className=\"left-text\">\r\n                <Form.File id=\"recipe_image\" label=\"Upload Image\" accept=\"image/*\" onChange={this.previewImage}>\r\n                </Form.File>\r\n                <img src={this.state.image} className=\"recipe-image\" id=\"preview\" alt=\"No file found\"/>\r\n                <Button onClick={this.deleteImage}>Remove Image</Button>\r\n            </Form.Group>\r\n\r\n            <Form.Row className=\"left-text spacing\">\r\n                <Col>\r\n                    <Form.Group as={Row}>\r\n                        <Form.Label column sm=\"4\" className=\"title\">Prep Time:</Form.Label>\r\n                        <Col sm=\"7\">\r\n                        <Form.Control name=\"prep\" type=\"text\" value={this.state.prep} onChange={this.handleInputChange}></Form.Control> \r\n                        </Col>\r\n                    </Form.Group>\r\n                </Col>\r\n\r\n                <Col>\r\n                    <Form.Group as={Row}>\r\n                        <Form.Label column sm=\"4\" className=\"title\">Cook Time:</Form.Label>\r\n                        <Col sm=\"7\">\r\n                        <Form.Control name=\"cook\" type=\"text\" value={this.state.cook} onChange={this.handleInputChange}></Form.Control>\r\n                        </Col>\r\n                    </Form.Group>\r\n                </Col>\r\n            </Form.Row>\r\n\r\n            <Form.Group className=\"left-text spacing\">\r\n            <Form.Label className=\"title\">Ingredients: </Form.Label>\r\n                <Form.Control name=\"ingredients\" as=\"textarea\" rows=\"4\" value={this.state.ingredients} onChange={this.handleInputChange}></Form.Control>\r\n            </Form.Group>\r\n\r\n            <Form.Group className=\"left-text spacing\">\r\n            <Form.Label className=\"title\">Directions</Form.Label>\r\n                <Form.Control name=\"directions\" as=\"textarea\" rows=\"4\" value={this.state.directions} onChange={this.handleInputChange}></Form.Control>\r\n            </Form.Group>\r\n\r\n            {buttons}\r\n            </Form>\r\n\r\n\r\n            <Modal\r\n        show={this.state.showModal}\r\n        onHide={this.handleClose}\r\n        backdrop=\"static\"\r\n        keyboard={false}\r\n      >\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Delete Recipe</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          Are you sure you want to delete this recipe?\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"secondary\" onClick={this.handleClose}>\r\n            No\r\n          </Button>\r\n          <Button variant=\"danger\" onClick={this.deleteRecipe}>Yes</Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n\r\n        </div>\r\n        )}\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\nconst mapDispatchToProps = {\r\n    addRecipe,\r\n    deleteRecipe,\r\n    editRecipe,\r\n    userInfo,\r\n    loading,\r\n    error\r\n};\r\n\r\nconst mapStateToProps = state => ({\r\n    added: state.added,\r\n    loggedIn: state.logged_in,\r\n    isLoading: state.isLoading,\r\n    error: state.error\r\n})\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps)(RecipeForm);"]},"metadata":{},"sourceType":"module"}