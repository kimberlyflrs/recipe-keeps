{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _lodash = require('lodash.isfunction');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _lodash3 = require('lodash.isobject');\n\nvar _lodash4 = _interopRequireDefault(_lodash3);\n\nvar _actions = require('./actions');\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nfunction swallow() {}\n\nfunction warnAboutConfusingFiltering(blacklist, whitelist) {\n  blacklist.filter(function (item) {\n    return whitelist.indexOf(item) !== -1;\n  }).forEach(function (item) {\n    console.warn( // eslint-disable-line no-console\n    '[redux-storage] Action ' + item + ' is on BOTH black- and whitelist.' + ' This is most likely a mistake!');\n  });\n}\n\nfunction isValidAction(action) {\n  var isFunc = (0, _lodash2['default'])(action);\n  var isObj = (0, _lodash4['default'])(action);\n  var hasType = isObj && action.hasOwnProperty('type');\n\n  if (!isFunc && isObj && hasType) {\n    return true;\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (isFunc) {\n      console.warn( // eslint-disable-line no-console\n      '[redux-storage] ACTION IGNORED! Actions should be objects' + ' with a type property but received a function! Your' + ' function resolving middleware (e.g. redux-thunk) must be' + ' placed BEFORE redux-storage!');\n    } else if (!isObj) {\n      console.warn( // eslint-disable-line no-console\n      '[redux-storage] ACTION IGNORED! Actions should be objects' + (' with a type property but received: ' + action));\n    } else if (!hasType) {\n      console.warn( // eslint-disable-line no-console\n      '[redux-storage] ACTION IGNORED! Action objects should have' + ' a type property.');\n    }\n  }\n\n  return false;\n}\n\nfunction handleWhitelist(action, actionWhitelist) {\n  if (Array.isArray(actionWhitelist)) {\n    return actionWhitelist.length === 0 ? true // Don't filter if the whitelist is empty\n    : actionWhitelist.indexOf(action.type) !== -1;\n  } // actionWhitelist is a function that returns true or false\n\n\n  return actionWhitelist(action);\n}\n\nexports['default'] = function (engine) {\n  var actionBlacklist = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var actionWhitelist = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : []; // Also don't save if we process our own actions\n\n  var blacklistedActions = [].concat(_toConsumableArray(actionBlacklist), [_constants.LOAD, _constants.SAVE]);\n\n  if (process.env.NODE_ENV !== 'production' && Array.isArray(actionWhitelist)) {\n    warnAboutConfusingFiltering(actionBlacklist, actionWhitelist);\n  }\n\n  return function (_ref) {\n    var dispatch = _ref.dispatch,\n        getState = _ref.getState;\n    return function (next) {\n      return function (action) {\n        var result = next(action);\n\n        if (!isValidAction(action)) {\n          return result;\n        }\n\n        var isOnBlacklist = blacklistedActions.indexOf(action.type) !== -1;\n        var isOnWhitelist = handleWhitelist(action, actionWhitelist); // Skip blacklisted actions\n\n        if (!isOnBlacklist && isOnWhitelist) {\n          (function () {\n            var saveState = getState();\n            var saveAction = (0, _actions.save)(saveState);\n\n            if (process.env.NODE_ENV !== 'production') {\n              if (!saveAction.meta) {\n                saveAction.meta = {};\n              }\n\n              saveAction.meta.origin = action;\n            }\n\n            var dispatchSave = function dispatchSave() {\n              return dispatch(saveAction);\n            };\n\n            engine.save(saveState).then(dispatchSave)['catch'](swallow);\n          })();\n        }\n\n        return result;\n      };\n    };\n  };\n};","map":{"version":3,"sources":["C:/Users/Kim/Documents/GitHub/recipe-keeps/client/node_modules/redux-storage/build/createMiddleware.js"],"names":["Object","defineProperty","exports","value","_lodash","require","_lodash2","_interopRequireDefault","_lodash3","_lodash4","_actions","_constants","obj","__esModule","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","swallow","warnAboutConfusingFiltering","blacklist","whitelist","filter","item","indexOf","forEach","console","warn","isValidAction","action","isFunc","isObj","hasType","hasOwnProperty","process","env","NODE_ENV","handleWhitelist","actionWhitelist","type","engine","actionBlacklist","arguments","undefined","blacklistedActions","concat","LOAD","SAVE","_ref","dispatch","getState","next","result","isOnBlacklist","isOnWhitelist","saveState","saveAction","save","meta","origin","dispatchSave","then"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _lodash = require('lodash.isfunction');\n\nvar _lodash2 = _interopRequireDefault(_lodash);\n\nvar _lodash3 = require('lodash.isobject');\n\nvar _lodash4 = _interopRequireDefault(_lodash3);\n\nvar _actions = require('./actions');\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction swallow() {}\n\nfunction warnAboutConfusingFiltering(blacklist, whitelist) {\n    blacklist.filter(function (item) {\n        return whitelist.indexOf(item) !== -1;\n    }).forEach(function (item) {\n        console.warn( // eslint-disable-line no-console\n        '[redux-storage] Action ' + item + ' is on BOTH black- and whitelist.' + ' This is most likely a mistake!');\n    });\n}\n\nfunction isValidAction(action) {\n    var isFunc = (0, _lodash2['default'])(action);\n    var isObj = (0, _lodash4['default'])(action);\n    var hasType = isObj && action.hasOwnProperty('type');\n\n    if (!isFunc && isObj && hasType) {\n        return true;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n        if (isFunc) {\n            console.warn( // eslint-disable-line no-console\n            '[redux-storage] ACTION IGNORED! Actions should be objects' + ' with a type property but received a function! Your' + ' function resolving middleware (e.g. redux-thunk) must be' + ' placed BEFORE redux-storage!');\n        } else if (!isObj) {\n            console.warn( // eslint-disable-line no-console\n            '[redux-storage] ACTION IGNORED! Actions should be objects' + (' with a type property but received: ' + action));\n        } else if (!hasType) {\n            console.warn( // eslint-disable-line no-console\n            '[redux-storage] ACTION IGNORED! Action objects should have' + ' a type property.');\n        }\n    }\n\n    return false;\n}\n\nfunction handleWhitelist(action, actionWhitelist) {\n    if (Array.isArray(actionWhitelist)) {\n        return actionWhitelist.length === 0 ? true // Don't filter if the whitelist is empty\n        : actionWhitelist.indexOf(action.type) !== -1;\n    }\n\n    // actionWhitelist is a function that returns true or false\n    return actionWhitelist(action);\n}\n\nexports['default'] = function (engine) {\n    var actionBlacklist = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n    var actionWhitelist = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n\n    // Also don't save if we process our own actions\n    var blacklistedActions = [].concat(_toConsumableArray(actionBlacklist), [_constants.LOAD, _constants.SAVE]);\n\n    if (process.env.NODE_ENV !== 'production' && Array.isArray(actionWhitelist)) {\n        warnAboutConfusingFiltering(actionBlacklist, actionWhitelist);\n    }\n\n    return function (_ref) {\n        var dispatch = _ref.dispatch,\n            getState = _ref.getState;\n\n        return function (next) {\n            return function (action) {\n                var result = next(action);\n\n                if (!isValidAction(action)) {\n                    return result;\n                }\n\n                var isOnBlacklist = blacklistedActions.indexOf(action.type) !== -1;\n                var isOnWhitelist = handleWhitelist(action, actionWhitelist);\n\n                // Skip blacklisted actions\n                if (!isOnBlacklist && isOnWhitelist) {\n                    (function () {\n                        var saveState = getState();\n                        var saveAction = (0, _actions.save)(saveState);\n\n                        if (process.env.NODE_ENV !== 'production') {\n                            if (!saveAction.meta) {\n                                saveAction.meta = {};\n                            }\n                            saveAction.meta.origin = action;\n                        }\n\n                        var dispatchSave = function dispatchSave() {\n                            return dispatch(saveAction);\n                        };\n                        engine.save(saveState).then(dispatchSave)['catch'](swallow);\n                    })();\n                }\n\n                return result;\n            };\n        };\n    };\n};"]},"metadata":{},"sourceType":"script"}