{"ast":null,"code":"import { ADD_RECIPE, DELETE_RECIPE, EDIT_RECIPE, LOGIN, LOGOUT, LOAD_USER, SIGNUP, VERIFY } from \"../actionType\";\nimport axios from \"axios\";\n\nfunction setAuth(token) {\n  if (token) {\n    console.log('adding token: ' + token);\n    axios.defaults.headers.common = {\n      'Authorization': `bearer ` + token\n    }; //console.log('added the token');\n  } else {\n    console.log('deleting token: ' + token);\n    delete axios.defaults.headers.common;\n  }\n}\n\n;\nconst initialState = {\n  logged_in: false,\n  registered: false,\n  added: false,\n  token: \"\",\n  recipes: []\n};\n\nconst recipes = (state = initialState, action) => {\n  switch (action.type) {\n    case ADD_RECIPE:\n      {\n        //if things went well true, if token expired then remove it from local storage\n        if (action.payload.status === 200) {\n          return { ...state,\n            added: true,\n            recipes: [...state.recipes, action.payload.recipe]\n          };\n        }\n\n        if (action.payload.status === 401) {\n          localStorage.removeItem('token');\n          return {\n            logged_in: false,\n            registered: false,\n            added: false,\n            token: \"\",\n            recipes: []\n          };\n        } else {\n          console.log(\"recipe error\");\n          return {\n            state\n          };\n        }\n      }\n\n    case DELETE_RECIPE:\n      {\n        if (action.payload.status === 200) {\n          return { ...state,\n            recipes: state.recipes.slice(action.index - 1, action.index).concat(state.recipes.slice(action.index + 1))\n          };\n        }\n\n        if (action.payload.status === 401) {\n          //remove fom localstorage\n          localStorage.removeItem('token');\n          return {\n            logged_in: false,\n            registered: false,\n            added: false,\n            token: \"\",\n            recipes: []\n          };\n        }\n      }\n\n    case EDIT_RECIPE:\n      {\n        //look at the recipe, slice at that point, concat previous point with edit point with end point\n        if (action.payload.status === 200) {\n          return { ...state,\n            recipes: state.recipes.slice(action.index - 1, action.index).concat(action.recipe).concat(state.recipes.slice(action.index + 1))\n          };\n        }\n\n        if (action.payload.status === 401) {\n          localStorage.removeItem('token');\n          return {\n            logged_in: false,\n            registered: false,\n            added: false,\n            token: \"\",\n            recipes: []\n          };\n        }\n      }\n\n    case LOGIN:\n      {\n        if (action.payload.status === 200) {\n          //set the token\n          localStorage.setItem(\"token\", action.payload.acessToken);\n          console.log(\"token has been set \" + action.payload.acessToken);\n          setAuth(localStorage.getItem('token'));\n          return { ...state,\n            registered: true,\n            token: action.payload.acessToken,\n            logged_in: true\n          };\n        } else {\n          console.log(\"can't login\");\n          return {\n            state\n          };\n        }\n      }\n\n    case LOGOUT:\n      {\n        //remove the token, sets all user info blank\n        localStorage.removeItem(\"token\");\n        return { ...state,\n          logged_in: false,\n          registered: false,\n          added: false,\n          token: \"\",\n          recipes: []\n        };\n      }\n\n    case LOAD_USER:\n      {\n        //sets the recipe entries into state.recipes\n        console.log('load user');\n\n        if (action.payload.status === 200) {\n          return { ...state,\n            recipes: action.payload.message\n          };\n        }\n\n        localstorage.removeItem('token');\n        return { ...state,\n          logged_in: false,\n          registered: false,\n          added: false,\n          token: \"\",\n          recipes: []\n        };\n      }\n\n    case VERIFY:\n      {\n        console.log(action.payload);\n        const token = localStorage.getItem(\"token\");\n\n        if (action.payload.status === 200) {\n          return { ...state,\n            logged_in: true,\n            registered: true,\n            added: false,\n            token: token\n          };\n        }\n\n        localStorage.removeItem('token');\n        return { ...state,\n          logged_in: false,\n          registered: false,\n          added: false,\n          token: \"\",\n          recipes: []\n        };\n      }\n\n    case SIGNUP:\n      {\n        //sets registered to true\n        if (action.payload.status === 200) {\n          return { ...state,\n            registered: true\n          };\n        }\n\n        return {\n          state\n        };\n      }\n\n    default:\n      return state;\n  }\n};\n\nexport default recipes;","map":{"version":3,"sources":["C:/Users/Kim/Documents/GitHub/recipe-keeps/client/src/redux/reducers/index.js"],"names":["ADD_RECIPE","DELETE_RECIPE","EDIT_RECIPE","LOGIN","LOGOUT","LOAD_USER","SIGNUP","VERIFY","axios","setAuth","token","console","log","defaults","headers","common","initialState","logged_in","registered","added","recipes","state","action","type","payload","status","recipe","localStorage","removeItem","slice","index","concat","setItem","acessToken","getItem","message","localstorage"],"mappings":"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","sourcesContent":["import { ADD_RECIPE, DELETE_RECIPE, EDIT_RECIPE, LOGIN, LOGOUT, LOAD_USER, SIGNUP, VERIFY } from \"../actionType\";\r\n\r\nimport axios from \"axios\";\r\n\r\nfunction setAuth(token){\r\n  if (token) {\r\n    console.log('adding token: '+token);\r\n    axios.defaults.headers.common = {'Authorization': `bearer `+token};\r\n    //console.log('added the token');\r\n  } else {\r\n    console.log('deleting token: '+token);\r\n    delete axios.defaults.headers.common;\r\n  }\r\n};\r\n\r\nconst initialState = {\r\n  logged_in: false,\r\n  registered: false,\r\n  added: false,\r\n  token: \"\",\r\n  recipes: []\r\n};\r\n\r\n\r\nconst recipes = (state = initialState, action) =>{\r\n  switch (action.type) {\r\n    case ADD_RECIPE: {\r\n      //if things went well true, if token expired then remove it from local storage\r\n      if(action.payload.status===200){\r\n        return{\r\n          ...state,\r\n          added:true,\r\n          recipes: [...state.recipes, action.payload.recipe]\r\n        }       \r\n      }\r\n      if(action.payload.status === 401){\r\n        localStorage.removeItem('token');\r\n        return{\r\n          logged_in: false,\r\n          registered: false,\r\n          added: false,\r\n          token:\"\",\r\n          recipes: []   \r\n        }\r\n      }\r\n      else{\r\n        console.log(\"recipe error\");\r\n        return {state}\r\n      }\r\n    }\r\n\r\n    case DELETE_RECIPE:{\r\n      if(action.payload.status===200){\r\n        return{\r\n          ...state,\r\n          recipes: state.recipes.slice(action.index-1, action.index).concat(state.recipes.slice(action.index+1))\r\n        }\r\n      }\r\n      if(action.payload.status===401){\r\n        //remove fom localstorage\r\n        localStorage.removeItem('token');\r\n        return{\r\n          logged_in: false,\r\n          registered: false,\r\n          added: false,\r\n          token:\"\",\r\n          recipes: []\r\n        }\r\n      }\r\n    }\r\n\r\n    case EDIT_RECIPE:{\r\n      //look at the recipe, slice at that point, concat previous point with edit point with end point\r\n      if(action.payload.status===200){\r\n        return{\r\n          ...state,\r\n          recipes: state.recipes.slice(action.index-1, action.index).concat(action.recipe).concat(state.recipes.slice(action.index+1))\r\n        }\r\n      }\r\n      if(action.payload.status===401){\r\n        localStorage.removeItem('token');\r\n        return{\r\n          logged_in: false,\r\n          registered: false,\r\n          added: false,\r\n          token:\"\",\r\n          recipes: []\r\n        }       \r\n      }\r\n    }\r\n\r\n\r\n    case LOGIN:{\r\n      if(action.payload.status===200){\r\n        //set the token\r\n        localStorage.setItem(\"token\", action.payload.acessToken);\r\n        console.log(\"token has been set \"+action.payload.acessToken);\r\n        setAuth(localStorage.getItem('token'));\r\n        return {...state, registered:true, token:action.payload.acessToken, logged_in:true}\r\n      }\r\n      else{\r\n        console.log(\"can't login\");\r\n        return {state}\r\n      }\r\n    }\r\n\r\n\r\n    case LOGOUT:{\r\n        //remove the token, sets all user info blank\r\n        localStorage.removeItem(\"token\");\r\n        return {...state, logged_in:false, registered: false, added:false,token:\"\", recipes:[]}\r\n    }\r\n\r\n  \r\n\r\n    case LOAD_USER:{\r\n      //sets the recipe entries into state.recipes\r\n      console.log('load user');\r\n      if(action.payload.status===200){\r\n        return {...state, recipes:action.payload.message}\r\n      }\r\n      localstorage.removeItem('token')\r\n      return {...state, logged_in:false, registered: false, added:false,token:\"\", recipes:[]}\r\n    }\r\n\r\n    case VERIFY:{\r\n      console.log(action.payload);\r\n      const token = localStorage.getItem(\"token\");\r\n\r\n      if(action.payload.status===200){\r\n        return{...state, logged_in:true, registered:true, added:false, token:token}\r\n      }\r\n      localStorage.removeItem('token');\r\n      return {...state, logged_in:false, registered: false, added:false,token:\"\", recipes:[]}\r\n    }\r\n\r\n    case SIGNUP:{\r\n      //sets registered to true\r\n      if(action.payload.status===200){\r\n        return {...state, registered:true}\r\n      }\r\n      return {state}\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport default recipes;"]},"metadata":{},"sourceType":"module"}